seed: 42
device: "cuda:0"

data:
  kind: "pems"
  raw_dir: "./data/pems/raw"
  cache_dir: "./data/pems/processed"
  x_min: 0.0
  x_max: 15000.0
  dt: 30.0
  t_hist: 600
  t_pred: 1800
  lanes: 4
  v_max: 35.0
  rho_jam_per_lane: 140.0
  normalize: true

train:
  phases:
    - name: "phaseA_fixed_Ve"
      epochs: 2500
      learn_Ve: false
      use_rar: false
    - name: "phaseB_learn_Ve"
      epochs: 3500
      learn_Ve: true
      use_rar: false
    - name: "phaseC_RAR"
      epochs: 2000
      learn_Ve: true
      use_rar: true
  lr: 1.0e-3
  batch_collocation: 4096
  rar_top_ratio: 0.4
  rar_every: 500

model:
  hidden_layers: 6
  hidden_units: 128
  activation: "tanh"
  ve_knots: 8
  ve_smooth_reg: 1.0e-3
  alpha_init: 8.0
  tau_init: 20.0
  alpha_bounds: [1.0, 20.0]
  tau_bounds: [5.0, 60.0]

loss_weights:
  w_mass: 1.0
  w_mom: 1.0
  w_data_q: 1.0
  w_data_v: 1.0
  w_data_rho_weak: 0.5
  w_ic: 0.5
  w_bc_in: 1.0
  w_bc_out: 0.5
  w_mono: 0.1
  w_prior: 0.01
  huber_delta: 2.0

eval:
  horizons: [300, 600, 900, 1800]
  wavefront_rho_thr_frac: 0.35

logging:
  log_interval: 200
  ckpt_interval: 1000
  ckpt_dir: "./checkpoints/pems"
  output_dir: "./outputs/pems"
